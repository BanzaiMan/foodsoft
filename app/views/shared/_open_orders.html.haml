%section
  %h2 Laufende Bestellungen
  - if ordergroup.not_enough_apples?
    .alert Achtung, Deine Bestellgruppe hat zu wenig Äpfel um Bestellen zu können!
  - unless Order.open.empty?
    %table.table.table-striped
      %thead
        %tr
          %th Lieferantin
          %th Ende
          %th Wer hat bestellt?
          %th Summe
      %tbody
        - total = 0
        - Order.open.each do |order|
          %tr
            %td= link_to_ordering(order)
            %td= format_time(order.ends) unless order.ends.nil?
            - if group_order = order.group_order(ordergroup)
              - total += group_order.price
              %td= "#{group_order.updated_by.nick} (#{format_time(group_order.updated_on)})"
              %td.numeric= number_to_currency(group_order.price)
            - else
              %td{:colspan => 2}
      - if total > 0
        %tfooter
          %tr
            %th(colspan="2")
            %th Gesamtsumme:
            %th.numeric= number_to_currency(total)
  - else
    %i Derzeit gibt es keine laufenden Bestellungen