// Handle more advanced DOM update after AJAX database manipulation.
// See publish/subscribe design pattern in /doc.
(function(w) {
  // get old element and update the cell which is reused
  var old_order_article_entry = $('#order_article_<%= @order_article.id %>');
  
  $('td.units_received_cell .package', old_order_article_entry).text(
    'Ã— <%= @order_article.article_price.unit_quantity %>'
  );
  
  // render new element and inject dynamic cell
  var new_order_article_entry = $(
    '<%= j render(partial: 'edit_amount', locals: {order_article: @order_article}) %>'
  );
  
  $('td.units_received_cell', new_order_article_entry).replaceWith(
    $('td.units_received_cell', old_order_article_entry)
  );
  
  // finally replace the OrderArticle entry
  old_order_article_entry.replaceWith(new_order_article_entry);
  
  update_delta($('input.units_received', new_order_article_entry));
})(window);

